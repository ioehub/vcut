var ha=Object.defineProperty;var ga=(y,c,P)=>c in y?ha(y,c,{enumerable:!0,configurable:!0,writable:!0,value:P}):y[c]=P;var z=(y,c,P)=>(ga(y,typeof c!="symbol"?c+"":c,P),P),yt=(y,c,P)=>{if(!c.has(y))throw TypeError("Cannot "+P)};var v=(y,c,P)=>(yt(y,c,"read from private field"),P?P.call(y):c.get(y)),re=(y,c,P)=>{if(c.has(y))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(y):c.set(y,P)},ye=(y,c,P,le)=>(yt(y,c,"write to private field"),le?le.call(y,P):c.set(y,P),P);(function(y,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],c):(y=typeof globalThis<"u"?globalThis:y||self,c(y.VCutMedia={},y.React))})(this,function(y,c){var Z,ae,$,ne,oe,ve,W;"use strict";var P=typeof document<"u"?document.currentScript:null,le={exports:{}},ue={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Le;function xt(){if(Le)return ue;Le=1;var t=c,a=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function h(p,d,m){var I,E={},A=null,j=null;m!==void 0&&(A=""+m),d.key!==void 0&&(A=""+d.key),d.ref!==void 0&&(j=d.ref);for(I in d)n.call(d,I)&&!f.hasOwnProperty(I)&&(E[I]=d[I]);if(p&&p.defaultProps)for(I in d=p.defaultProps,d)E[I]===void 0&&(E[I]=d[I]);return{$$typeof:a,type:p,key:A,ref:j,props:E,_owner:s.current}}return ue.Fragment=r,ue.jsx=h,ue.jsxs=h,ue}var fe={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pe;function vt(){return Pe||(Pe=1,process.env.NODE_ENV!=="production"&&function(){var t=c,a=Symbol.for("react.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),p=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),S=Symbol.iterator,N="@@iterator";function ee(e){if(e===null||typeof e!="object")return null;var i=S&&e[S]||e[N];return typeof i=="function"?i:null}var H=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function M(e){{for(var i=arguments.length,l=new Array(i>1?i-1:0),g=1;g<i;g++)l[g-1]=arguments[g];U("error",e,l)}}function U(e,i,l){{var g=H.ReactDebugCurrentFrame,T=g.getStackAddendum();T!==""&&(i+="%s",l=l.concat([T]));var O=l.map(function(_){return String(_)});O.unshift("Warning: "+i),Function.prototype.apply.call(console[e],console,O)}}var G=!1,q=!1,x=!1,b=!1,u=!1,w;w=Symbol.for("react.module.reference");function k(e){return!!(typeof e=="string"||typeof e=="function"||e===n||e===f||u||e===s||e===m||e===I||b||e===j||G||q||x||typeof e=="object"&&e!==null&&(e.$$typeof===A||e.$$typeof===E||e.$$typeof===h||e.$$typeof===p||e.$$typeof===d||e.$$typeof===w||e.getModuleId!==void 0))}function J(e,i,l){var g=e.displayName;if(g)return g;var T=i.displayName||i.name||"";return T!==""?l+"("+T+")":l}function pe(e){return e.displayName||"Context"}function K(e){if(e==null)return null;if(typeof e.tag=="number"&&M("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case n:return"Fragment";case r:return"Portal";case f:return"Profiler";case s:return"StrictMode";case m:return"Suspense";case I:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case p:var i=e;return pe(i)+".Consumer";case h:var l=e;return pe(l._context)+".Provider";case d:return J(e,e.render,"ForwardRef");case E:var g=e.displayName||null;return g!==null?g:K(e.type)||"Memo";case A:{var T=e,O=T._payload,_=T._init;try{return K(_(O))}catch{return null}}}return null}var ie=Object.assign,he=0,Ke,Xe,Qe,qe,$e,et,tt;function at(){}at.__reactDisabledLog=!0;function Bt(){{if(he===0){Ke=console.log,Xe=console.info,Qe=console.warn,qe=console.error,$e=console.group,et=console.groupCollapsed,tt=console.groupEnd;var e={configurable:!0,enumerable:!0,value:at,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}he++}}function Wt(){{if(he--,he===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:ie({},e,{value:Ke}),info:ie({},e,{value:Xe}),warn:ie({},e,{value:Qe}),error:ie({},e,{value:qe}),group:ie({},e,{value:$e}),groupCollapsed:ie({},e,{value:et}),groupEnd:ie({},e,{value:tt})})}he<0&&M("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var Se=H.ReactCurrentDispatcher,_e;function Ee(e,i,l){{if(_e===void 0)try{throw Error()}catch(T){var g=T.stack.trim().match(/\n( *(at )?)/);_e=g&&g[1]||""}return`
`+_e+e}}var Te=!1,be;{var Vt=typeof WeakMap=="function"?WeakMap:Map;be=new Vt}function rt(e,i){if(!e||Te)return"";{var l=be.get(e);if(l!==void 0)return l}var g;Te=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var O;O=Se.current,Se.current=null,Bt();try{if(i){var _=function(){throw Error()};if(Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(Y){g=Y}Reflect.construct(e,[],_)}else{try{_.call()}catch(Y){g=Y}e.call(_.prototype)}}else{try{throw Error()}catch(Y){g=Y}e()}}catch(Y){if(Y&&g&&typeof Y.stack=="string"){for(var R=Y.stack.split(`
`),V=g.stack.split(`
`),L=R.length-1,F=V.length-1;L>=1&&F>=0&&R[L]!==V[F];)F--;for(;L>=1&&F>=0;L--,F--)if(R[L]!==V[F]){if(L!==1||F!==1)do if(L--,F--,F<0||R[L]!==V[F]){var X=`
`+R[L].replace(" at new "," at ");return e.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",e.displayName)),typeof e=="function"&&be.set(e,X),X}while(L>=1&&F>=0);break}}}finally{Te=!1,Se.current=O,Wt(),Error.prepareStackTrace=T}var de=e?e.displayName||e.name:"",se=de?Ee(de):"";return typeof e=="function"&&be.set(e,se),se}function Gt(e,i,l){return rt(e,!1)}function Yt(e){var i=e.prototype;return!!(i&&i.isReactComponent)}function we(e,i,l){if(e==null)return"";if(typeof e=="function")return rt(e,Yt(e));if(typeof e=="string")return Ee(e);switch(e){case m:return Ee("Suspense");case I:return Ee("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case d:return Gt(e.render);case E:return we(e.type,i,l);case A:{var g=e,T=g._payload,O=g._init;try{return we(O(T),i,l)}catch{}}}return""}var ge=Object.prototype.hasOwnProperty,nt={},ot=H.ReactDebugCurrentFrame;function Re(e){if(e){var i=e._owner,l=we(e.type,e._source,i?i.type:null);ot.setExtraStackFrame(l)}else ot.setExtraStackFrame(null)}function Zt(e,i,l,g,T){{var O=Function.call.bind(ge);for(var _ in e)if(O(e,_)){var R=void 0;try{if(typeof e[_]!="function"){var V=Error((g||"React class")+": "+l+" type `"+_+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[_]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw V.name="Invariant Violation",V}R=e[_](i,_,g,l,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(L){R=L}R&&!(R instanceof Error)&&(Re(T),M("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",g||"React class",l,_,typeof R),Re(null)),R instanceof Error&&!(R.message in nt)&&(nt[R.message]=!0,Re(T),M("Failed %s type: %s",l,R.message),Re(null))}}}var Ht=Array.isArray;function De(e){return Ht(e)}function Jt(e){{var i=typeof Symbol=="function"&&Symbol.toStringTag,l=i&&e[Symbol.toStringTag]||e.constructor.name||"Object";return l}}function Kt(e){try{return it(e),!1}catch{return!0}}function it(e){return""+e}function st(e){if(Kt(e))return M("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",Jt(e)),it(e)}var me=H.ReactCurrentOwner,Xt={key:!0,ref:!0,__self:!0,__source:!0},lt,ct,Ce;Ce={};function Qt(e){if(ge.call(e,"ref")){var i=Object.getOwnPropertyDescriptor(e,"ref").get;if(i&&i.isReactWarning)return!1}return e.ref!==void 0}function qt(e){if(ge.call(e,"key")){var i=Object.getOwnPropertyDescriptor(e,"key").get;if(i&&i.isReactWarning)return!1}return e.key!==void 0}function $t(e,i){if(typeof e.ref=="string"&&me.current&&i&&me.current.stateNode!==i){var l=K(me.current.type);Ce[l]||(M('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',K(me.current.type),e.ref),Ce[l]=!0)}}function ea(e,i){{var l=function(){lt||(lt=!0,M("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",i))};l.isReactWarning=!0,Object.defineProperty(e,"key",{get:l,configurable:!0})}}function ta(e,i){{var l=function(){ct||(ct=!0,M("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",i))};l.isReactWarning=!0,Object.defineProperty(e,"ref",{get:l,configurable:!0})}}var aa=function(e,i,l,g,T,O,_){var R={$$typeof:a,type:e,key:i,ref:l,props:_,_owner:O};return R._store={},Object.defineProperty(R._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(R,"_self",{configurable:!1,enumerable:!1,writable:!1,value:g}),Object.defineProperty(R,"_source",{configurable:!1,enumerable:!1,writable:!1,value:T}),Object.freeze&&(Object.freeze(R.props),Object.freeze(R)),R};function ra(e,i,l,g,T){{var O,_={},R=null,V=null;l!==void 0&&(st(l),R=""+l),qt(i)&&(st(i.key),R=""+i.key),Qt(i)&&(V=i.ref,$t(i,T));for(O in i)ge.call(i,O)&&!Xt.hasOwnProperty(O)&&(_[O]=i[O]);if(e&&e.defaultProps){var L=e.defaultProps;for(O in L)_[O]===void 0&&(_[O]=L[O])}if(R||V){var F=typeof e=="function"?e.displayName||e.name||"Unknown":e;R&&ea(_,F),V&&ta(_,F)}return aa(e,R,V,T,g,me.current,_)}}var Oe=H.ReactCurrentOwner,dt=H.ReactDebugCurrentFrame;function ce(e){if(e){var i=e._owner,l=we(e.type,e._source,i?i.type:null);dt.setExtraStackFrame(l)}else dt.setExtraStackFrame(null)}var Ae;Ae=!1;function ke(e){return typeof e=="object"&&e!==null&&e.$$typeof===a}function ut(){{if(Oe.current){var e=K(Oe.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function na(e){{if(e!==void 0){var i=e.fileName.replace(/^.*[\\\/]/,""),l=e.lineNumber;return`

Check your code at `+i+":"+l+"."}return""}}var ft={};function oa(e){{var i=ut();if(!i){var l=typeof e=="string"?e:e.displayName||e.name;l&&(i=`

Check the top-level render call using <`+l+">.")}return i}}function pt(e,i){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var l=oa(i);if(ft[l])return;ft[l]=!0;var g="";e&&e._owner&&e._owner!==Oe.current&&(g=" It was passed a child from "+K(e._owner.type)+"."),ce(e),M('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',l,g),ce(null)}}function ht(e,i){{if(typeof e!="object")return;if(De(e))for(var l=0;l<e.length;l++){var g=e[l];ke(g)&&pt(g,i)}else if(ke(e))e._store&&(e._store.validated=!0);else if(e){var T=ee(e);if(typeof T=="function"&&T!==e.entries)for(var O=T.call(e),_;!(_=O.next()).done;)ke(_.value)&&pt(_.value,i)}}}function ia(e){{var i=e.type;if(i==null||typeof i=="string")return;var l;if(typeof i=="function")l=i.propTypes;else if(typeof i=="object"&&(i.$$typeof===d||i.$$typeof===E))l=i.propTypes;else return;if(l){var g=K(i);Zt(l,e.props,"prop",g,e)}else if(i.PropTypes!==void 0&&!Ae){Ae=!0;var T=K(i);M("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",T||"Unknown")}typeof i.getDefaultProps=="function"&&!i.getDefaultProps.isReactClassApproved&&M("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function sa(e){{for(var i=Object.keys(e.props),l=0;l<i.length;l++){var g=i[l];if(g!=="children"&&g!=="key"){ce(e),M("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",g),ce(null);break}}e.ref!==null&&(ce(e),M("Invalid attribute `ref` supplied to `React.Fragment`."),ce(null))}}var gt={};function mt(e,i,l,g,T,O){{var _=k(e);if(!_){var R="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(R+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var V=na(T);V?R+=V:R+=ut();var L;e===null?L="null":De(e)?L="array":e!==void 0&&e.$$typeof===a?(L="<"+(K(e.type)||"Unknown")+" />",R=" Did you accidentally export a JSX literal instead of a component?"):L=typeof e,M("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",L,R)}var F=ra(e,i,l,T,O);if(F==null)return F;if(_){var X=i.children;if(X!==void 0)if(g)if(De(X)){for(var de=0;de<X.length;de++)ht(X[de],e);Object.freeze&&Object.freeze(X)}else M("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ht(X,e)}if(ge.call(i,"key")){var se=K(e),Y=Object.keys(i).filter(function(pa){return pa!=="key"}),Me=Y.length>0?"{key: someKey, "+Y.join(": ..., ")+": ...}":"{key: someKey}";if(!gt[se+Me]){var fa=Y.length>0?"{"+Y.join(": ..., ")+": ...}":"{}";M(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,Me,se,fa,se),gt[se+Me]=!0}}return e===n?sa(F):ia(F),F}}function la(e,i,l){return mt(e,i,l,!0)}function ca(e,i,l){return mt(e,i,l,!1)}var da=ca,ua=la;fe.Fragment=n,fe.jsx=da,fe.jsxs=ua}()),fe}process.env.NODE_ENV==="production"?le.exports=xt():le.exports=vt();var o=le.exports;let xe;const Et=new Uint8Array(16);function bt(){if(!xe&&(xe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!xe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xe(Et)}const B=[];for(let t=0;t<256;++t)B.push((t+256).toString(16).slice(1));function wt(t,a=0){return B[t[a+0]]+B[t[a+1]]+B[t[a+2]]+B[t[a+3]]+"-"+B[t[a+4]]+B[t[a+5]]+"-"+B[t[a+6]]+B[t[a+7]]+"-"+B[t[a+8]]+B[t[a+9]]+"-"+B[t[a+10]]+B[t[a+11]]+B[t[a+12]]+B[t[a+13]]+B[t[a+14]]+B[t[a+15]]}const Ne={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Ue(t,a,r){if(Ne.randomUUID&&!a&&!t)return Ne.randomUUID();t=t||{};const n=t.random||(t.rng||bt)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,a){r=r||0;for(let s=0;s<16;++s)a[r+s]=n[s];return a}return wt(n)}var D;(function(t){t.LOAD="LOAD",t.EXEC="EXEC",t.FFPROBE="FFPROBE",t.WRITE_FILE="WRITE_FILE",t.READ_FILE="READ_FILE",t.DELETE_FILE="DELETE_FILE",t.RENAME="RENAME",t.CREATE_DIR="CREATE_DIR",t.LIST_DIR="LIST_DIR",t.DELETE_DIR="DELETE_DIR",t.ERROR="ERROR",t.DOWNLOAD="DOWNLOAD",t.PROGRESS="PROGRESS",t.LOG="LOG",t.MOUNT="MOUNT",t.UNMOUNT="UNMOUNT"})(D||(D={}));const Rt=(()=>{let t=0;return()=>t++})(),It=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),jt=new Error("called FFmpeg.terminate()");class St{constructor(){re(this,Z,null);re(this,ae,{});re(this,$,{});re(this,ne,[]);re(this,oe,[]);z(this,"loaded",!1);re(this,ve,()=>{v(this,Z)&&(v(this,Z).onmessage=({data:{id:a,type:r,data:n}})=>{switch(r){case D.LOAD:this.loaded=!0,v(this,ae)[a](n);break;case D.MOUNT:case D.UNMOUNT:case D.EXEC:case D.FFPROBE:case D.WRITE_FILE:case D.READ_FILE:case D.DELETE_FILE:case D.RENAME:case D.CREATE_DIR:case D.LIST_DIR:case D.DELETE_DIR:v(this,ae)[a](n);break;case D.LOG:v(this,ne).forEach(s=>s(n));break;case D.PROGRESS:v(this,oe).forEach(s=>s(n));break;case D.ERROR:v(this,$)[a](n);break}delete v(this,ae)[a],delete v(this,$)[a]})});re(this,W,({type:a,data:r},n=[],s)=>v(this,Z)?new Promise((f,h)=>{const p=Rt();v(this,Z)&&v(this,Z).postMessage({id:p,type:a,data:r},n),v(this,ae)[p]=f,v(this,$)[p]=h,s==null||s.addEventListener("abort",()=>{h(new DOMException(`Message # ${p} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(It));z(this,"load",({classWorkerURL:a,...r}={},{signal:n}={})=>(v(this,Z)||(ye(this,Z,a?new Worker(new URL(a,typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:P&&P.tagName.toUpperCase()==="SCRIPT"&&P.src||new URL("vcut-media.umd.cjs",document.baseURI).href),{type:"module"}):new Worker(new URL("/assets/worker-224792ee.js",self.location),{type:"module"})),v(this,ve).call(this)),v(this,W).call(this,{type:D.LOAD,data:r},void 0,n)));z(this,"exec",(a,r=-1,{signal:n}={})=>v(this,W).call(this,{type:D.EXEC,data:{args:a,timeout:r}},void 0,n));z(this,"ffprobe",(a,r=-1,{signal:n}={})=>v(this,W).call(this,{type:D.FFPROBE,data:{args:a,timeout:r}},void 0,n));z(this,"terminate",()=>{const a=Object.keys(v(this,$));for(const r of a)v(this,$)[r](jt),delete v(this,$)[r],delete v(this,ae)[r];v(this,Z)&&(v(this,Z).terminate(),ye(this,Z,null),this.loaded=!1)});z(this,"writeFile",(a,r,{signal:n}={})=>{const s=[];return r instanceof Uint8Array&&s.push(r.buffer),v(this,W).call(this,{type:D.WRITE_FILE,data:{path:a,data:r}},s,n)});z(this,"mount",(a,r,n)=>{const s=[];return v(this,W).call(this,{type:D.MOUNT,data:{fsType:a,options:r,mountPoint:n}},s)});z(this,"unmount",a=>{const r=[];return v(this,W).call(this,{type:D.UNMOUNT,data:{mountPoint:a}},r)});z(this,"readFile",(a,r="binary",{signal:n}={})=>v(this,W).call(this,{type:D.READ_FILE,data:{path:a,encoding:r}},void 0,n));z(this,"deleteFile",(a,{signal:r}={})=>v(this,W).call(this,{type:D.DELETE_FILE,data:{path:a}},void 0,r));z(this,"rename",(a,r,{signal:n}={})=>v(this,W).call(this,{type:D.RENAME,data:{oldPath:a,newPath:r}},void 0,n));z(this,"createDir",(a,{signal:r}={})=>v(this,W).call(this,{type:D.CREATE_DIR,data:{path:a}},void 0,r));z(this,"listDir",(a,{signal:r}={})=>v(this,W).call(this,{type:D.LIST_DIR,data:{path:a}},void 0,r));z(this,"deleteDir",(a,{signal:r}={})=>v(this,W).call(this,{type:D.DELETE_DIR,data:{path:a}},void 0,r))}on(a,r){a==="log"?v(this,ne).push(r):a==="progress"&&v(this,oe).push(r)}off(a,r){a==="log"?ye(this,ne,v(this,ne).filter(n=>n!==r)):a==="progress"&&ye(this,oe,v(this,oe).filter(n=>n!==r))}}Z=new WeakMap,ae=new WeakMap,$=new WeakMap,ne=new WeakMap,oe=new WeakMap,ve=new WeakMap,W=new WeakMap;var Fe;(function(t){t.MEMFS="MEMFS",t.NODEFS="NODEFS",t.NODERAWFS="NODERAWFS",t.IDBFS="IDBFS",t.WORKERFS="WORKERFS",t.PROXYFS="PROXYFS"})(Fe||(Fe={}));const _t=new Error("failed to get response body reader"),Tt=new Error("failed to complete download"),Dt="Content-Length",Ct=t=>new Promise((a,r)=>{const n=new FileReader;n.onload=()=>{const{result:s}=n;s instanceof ArrayBuffer?a(new Uint8Array(s)):a(new Uint8Array)},n.onerror=s=>{var f,h;r(Error(`File could not be read! Code=${((h=(f=s==null?void 0:s.target)==null?void 0:f.error)==null?void 0:h.code)||-1}`))},n.readAsArrayBuffer(t)}),ze=async t=>{let a;if(typeof t=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t)?a=atob(t.split(",")[1]).split("").map(r=>r.charCodeAt(0)):a=await(await fetch(t)).arrayBuffer();else if(t instanceof URL)a=await(await fetch(t)).arrayBuffer();else if(t instanceof File||t instanceof Blob)a=await Ct(t);else return new Uint8Array;return new Uint8Array(a)},Ot=async(t,a)=>{var s;const r=await fetch(t);let n;try{const f=parseInt(r.headers.get(Dt)||"-1"),h=(s=r.body)==null?void 0:s.getReader();if(!h)throw _t;const p=[];let d=0;for(;;){const{done:E,value:A}=await h.read(),j=A?A.length:0;if(E){if(f!=-1&&f!==d)throw Tt;a&&a({url:t,total:f,received:d,delta:j,done:E});break}p.push(A),d+=j,a&&a({url:t,total:f,received:d,delta:j,done:E})}const m=new Uint8Array(d);let I=0;for(const E of p)m.set(E,I),I+=E.length;n=m.buffer}catch(f){console.log("failed to send download progress event: ",f),n=await r.arrayBuffer(),a&&a({url:t,total:n.byteLength,received:n.byteLength,delta:0,done:!0})}return n},Be=async(t,a,r=!1,n)=>{const s=r?await Ot(t,n):await(await fetch(t)).arrayBuffer(),f=new Blob([s],{type:a});return URL.createObjectURL(f)};var C=(t=>(t.VIDEO="video",t.AUDIO="audio",t.IMAGE="image",t))(C||{});class At{constructor(){z(this,"ffmpeg",null);z(this,"loaded",!1)}async load(){if(!this.loaded){this.ffmpeg=new St;try{const a="https://unpkg.com/@ffmpeg";await this.ffmpeg.load({coreURL:await Be(`${a}/core/dist/ffmpeg-core.js`,"text/javascript"),wasmURL:await Be(`${a}/core/dist/ffmpeg-core.wasm`,"application/wasm")}),this.loaded=!0,console.log("FFmpeg 로드 완료")}catch(a){throw console.error("FFmpeg 로드 실패:",a),new Error("FFmpeg를 로드할 수 없습니다")}}}async extractMetadata(a){var r,n;if(await this.ensureLoaded(),!this.ffmpeg)throw new Error("FFmpeg가 초기화되지 않았습니다");try{await this.ffmpeg.writeFile("input",await ze(a)),await this.ffmpeg.exec(["-i","input","-v","error","-select_streams","v:0,a:0","-show_entries","stream=width,height,duration,r_frame_rate,bit_rate,codec_name:stream_tags","-of","json","output.json"]);const s=await this.ffmpeg.readFile("output.json"),f=new TextDecoder().decode(s),h=JSON.parse(f),p={},d=(r=h.streams)==null?void 0:r.find(E=>E.codec_type==="video");if(d){if(p.width=parseInt(d.width)||void 0,p.height=parseInt(d.height)||void 0,p.codec=d.codec_name,d.r_frame_rate){const[E,A]=d.r_frame_rate.split("/").map(Number);p.frameRate=E/A}p.bitRate=parseInt(d.bit_rate)||void 0}const m=(n=h.streams)==null?void 0:n.find(E=>E.codec_type==="audio");m&&(p.channels=parseInt(m.channels)||void 0,p.sampleRate=parseInt(m.sample_rate)||void 0);const I=h.format;return I!=null&&I.duration&&(p.duration=parseFloat(I.duration)),p}catch(s){throw console.error("메타데이터 추출 실패:",s),new Error("미디어 메타데이터를 추출할 수 없습니다")}finally{await this.ffmpeg.deleteFile("input"),await this.ffmpeg.deleteFile("output.json")}}async generateThumbnail(a,r,n={}){if(await this.ensureLoaded(),!this.ffmpeg)throw new Error("FFmpeg가 초기화되지 않았습니다");const{width:s=320,height:f=180,quality:h=90,time:p=0}=n;try{if(await this.ffmpeg.writeFile("input",await ze(a)),r===C.VIDEO)await this.ffmpeg.exec(["-ss",p.toString(),"-i","input","-vf",`scale=${s}:${f}:force_original_aspect_ratio=decrease`,"-vframes","1","-q:v",(31-Math.round(h/3.3)).toString(),"thumbnail.jpg"]);else if(r===C.IMAGE)await this.ffmpeg.exec(["-i","input","-vf",`scale=${s}:${f}:force_original_aspect_ratio=decrease`,"-q:v",(31-Math.round(h/3.3)).toString(),"thumbnail.jpg"]);else if(r===C.AUDIO)return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMjAiIGhlaWdodD0iMTgwIiB2aWV3Qm94PSIwIDAgMzIwIDE4MCIgZmlsbD0ibm9uZSI+PHJlY3Qgd2lkdGg9IjMyMCIgaGVpZ2h0PSIxODAiIGZpbGw9IiMzMzMzMzMiLz48cGF0aCBkPSJNMTQwIDYwdjYwbDUwLTMweiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0xOTAgOTBhNDAgNDAgMCAwIDEgMCAwIiBzdHJva2U9IiNmZmYiIHN0cm9rZS13aWR0aD0iNCIvPjxwYXRoIGQ9Ik0xOTAgNzBhNjAgNjAgMCAwIDEgMCA0MCIgc3Ryb2tlPSIjZmZmIiBzdHJva2Utd2lkdGg9IjQiLz48cGF0aCBkPSJNMTkwIDUwYTgwIDgwIDAgMCAxIDAgODAiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSI0Ii8+PC9zdmc+";const d=await this.ffmpeg.readFile("thumbnail.jpg"),m=new Blob([d],{type:"image/jpeg"});return URL.createObjectURL(m)}catch(d){throw console.error("썸네일 생성 실패:",d),new Error("썸네일을 생성할 수 없습니다")}finally{await this.ffmpeg.deleteFile("input"),await this.ffmpeg.deleteFile("thumbnail.jpg").catch(()=>{})}}async ensureLoaded(){this.loaded||await this.load()}async terminate(){this.ffmpeg&&(await this.ffmpeg.terminate(),this.ffmpeg=null,this.loaded=!1)}}const te=new At;class kt{constructor(){z(this,"items",new Map)}async importMedia(a){const r=[];for(const n of a)try{const s=this.detectMediaType(n),f=await te.extractMetadata(n),h=await this.createMediaItem({name:n.name,type:s,path:URL.createObjectURL(n),size:n.size,metadata:f}),p=await te.generateThumbnail(n,s);h.thumbnail=p,this.items.set(h.id,h),r.push(h)}catch(s){console.error(`파일 임포트 실패: ${n.name}`,s)}return r}async getMediaItems(a={}){let r=Array.from(this.items.values());if(a.type&&a.type.length>0&&(r=r.filter(n=>a.type.includes(n.type))),a.tags&&a.tags.length>0&&(r=r.filter(n=>a.tags.some(s=>n.tags.includes(s)))),a.favorite!==void 0&&(r=r.filter(n=>n.favorite===a.favorite)),a.search){const n=a.search.toLowerCase();r=r.filter(s=>s.name.toLowerCase().includes(n)||s.tags.some(f=>f.toLowerCase().includes(n)))}if(a.sortBy){const n=a.sortDirection==="desc"?-1:1;r.sort((s,f)=>{switch(a.sortBy){case"name":return n*s.name.localeCompare(f.name);case"size":return n*(s.size-f.size);case"createdAt":return n*(s.createdAt.getTime()-f.createdAt.getTime());case"importedAt":return n*(s.importedAt.getTime()-f.importedAt.getTime());case"duration":const h=s.metadata.duration||0,p=f.metadata.duration||0;return n*(h-p);default:return 0}})}return r}async getMediaById(a){return this.items.get(a)||null}async updateMedia(a,r){const n=this.items.get(a);if(!n)throw new Error(`미디어 항목을 찾을 수 없음: ${a}`);const s={...n,...r};return this.items.set(a,s),s}async deleteMedia(a){const r=this.items.get(a);return r&&(URL.revokeObjectURL(r.url),r.thumbnail&&r.thumbnail.startsWith("blob:")&&URL.revokeObjectURL(r.thumbnail)),this.items.delete(a)}async generateThumbnail(a,r){try{const s=await(await fetch(a.url)).blob(),f=new File([s],a.name,{type:this.getMimeType(a.type)}),h=await te.generateThumbnail(f,a.type,r);return a.thumbnail&&a.thumbnail.startsWith("blob:")&&URL.revokeObjectURL(a.thumbnail),a.thumbnail=h,this.items.set(a.id,a),h}catch(n){throw console.error("썸네일 생성 실패:",n),new Error("썸네일을 생성할 수 없습니다")}}async extractMetadata(a){return await te.extractMetadata(a)}async createMediaItem(a){const r=new Date;return{id:Ue(),name:a.name,type:a.type,path:a.path,url:a.path,size:a.size,createdAt:r,importedAt:r,metadata:a.metadata||{},tags:a.tags||[],favorite:a.favorite||!1,thumbnail:""}}detectMediaType(a){var p;const r=a.type.toLowerCase();if(r.startsWith("video/"))return C.VIDEO;if(r.startsWith("audio/"))return C.AUDIO;if(r.startsWith("image/"))return C.IMAGE;const n=(p=a.name.split(".").pop())==null?void 0:p.toLowerCase(),s=["mp4","avi","mov","wmv","flv","mkv","webm"],f=["mp3","wav","ogg","aac","m4a","flac"],h=["jpg","jpeg","png","gif","bmp","webp","svg"];return n&&s.includes(n)?C.VIDEO:n&&f.includes(n)?C.AUDIO:n&&h.includes(n)?C.IMAGE:C.VIDEO}getMimeType(a){switch(a){case C.VIDEO:return"video/mp4";case C.AUDIO:return"audio/mp3";case C.IMAGE:return"image/jpeg";default:return"application/octet-stream"}}}const Q=new kt,Mt={items:[],selectedItems:[],isLoading:!1,error:null,filter:{}};function Lt(t,a){switch(a.type){case"SET_ITEMS":return{...t,items:a.payload};case"ADD_ITEMS":return{...t,items:[...t.items,...a.payload]};case"UPDATE_ITEM":return{...t,items:t.items.map(r=>r.id===a.payload.id?a.payload:r)};case"REMOVE_ITEM":return{...t,items:t.items.filter(r=>r.id!==a.payload),selectedItems:t.selectedItems.filter(r=>r!==a.payload)};case"SELECT_ITEM":return{...t,selectedItems:[...t.selectedItems,a.payload]};case"DESELECT_ITEM":return{...t,selectedItems:t.selectedItems.filter(r=>r!==a.payload)};case"SELECT_ALL":return{...t,selectedItems:t.items.map(r=>r.id)};case"DESELECT_ALL":return{...t,selectedItems:[]};case"SET_FILTER":return{...t,filter:a.payload};case"SET_LOADING":return{...t,isLoading:a.payload};case"SET_ERROR":return{...t,error:a.payload};default:return t}}const We=c.createContext(void 0),Pt=({children:t})=>{const[a,r]=c.useReducer(Lt,Mt),n=async j=>{try{r({type:"SET_LOADING",payload:!0}),r({type:"SET_ERROR",payload:null});const S=await Q.importMedia(j);return r({type:"ADD_ITEMS",payload:S}),S}catch(S){return r({type:"SET_ERROR",payload:S}),[]}finally{r({type:"SET_LOADING",payload:!1})}},s=async j=>{try{r({type:"SET_LOADING",payload:!0}),r({type:"SET_ERROR",payload:null});const S=j||a.filter;j&&r({type:"SET_FILTER",payload:j});const N=await Q.getMediaItems(S);r({type:"SET_ITEMS",payload:N})}catch(S){r({type:"SET_ERROR",payload:S})}finally{r({type:"SET_LOADING",payload:!1})}},A={state:a,importMedia:n,refreshMedia:s,updateMedia:async(j,S)=>{try{r({type:"SET_ERROR",payload:null});const N=await Q.updateMedia(j,S);return r({type:"UPDATE_ITEM",payload:N}),N}catch(N){throw r({type:"SET_ERROR",payload:N}),N}},deleteMedia:async j=>{try{r({type:"SET_ERROR",payload:null});const S=await Q.deleteMedia(j);return S&&r({type:"REMOVE_ITEM",payload:j}),S}catch(S){return r({type:"SET_ERROR",payload:S}),!1}},selectItem:j=>{a.selectedItems.includes(j)||r({type:"SELECT_ITEM",payload:j})},deselectItem:j=>{r({type:"DESELECT_ITEM",payload:j})},selectAll:()=>{r({type:"SELECT_ALL"})},deselectAll:()=>{r({type:"DESELECT_ALL"})},setFilter:j=>{r({type:"SET_FILTER",payload:j}),s(j)}};return o.jsx(We.Provider,{value:A,children:t})},Ve=()=>{const t=c.useContext(We);if(!t)throw new Error("useMedia must be used within a MediaProvider");return t},Ge=({selectedCount:t,totalCount:a,filter:r,onImport:n,onFilterChange:s,onDeleteSelected:f,onRefresh:h})=>{var ee,H,M;const[p,d]=c.useState(r.search||""),m=c.useRef(null),I=c.useCallback(U=>{const G=U.target.value;d(G),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{s({...r,search:G})},300)},[r,s]),E=c.useCallback((U,G)=>{const q=r.type||[];let x;G?x=[...q,U]:x=q.filter(b=>b!==U),s({...r,type:x.length>0?x:void 0})},[r,s]),A=c.useCallback(U=>{const G=U.target.checked;s({...r,favorite:G?!0:void 0})},[r,s]),j=c.useCallback(U=>{const G=U.target.value,[q,x]=G.split("-");s({...r,sortBy:q,sortDirection:x})},[r,s]),S=`${r.sortBy||"name"}-${r.sortDirection||"asc"}`,N=c.useCallback(()=>{d(""),s({})},[s]);return o.jsxs("div",{className:"media-toolbar",style:{display:"flex",flexDirection:"column",gap:"8px",padding:"12px",backgroundColor:"#212121",borderBottom:"1px solid #333"},children:[o.jsxs("div",{className:"media-toolbar-main",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[o.jsxs("div",{className:"media-toolbar-left",style:{display:"flex",alignItems:"center",gap:"8px",flex:"1"},children:[o.jsxs("div",{className:"search-container",style:{flex:"1",position:"relative",maxWidth:"300px"},children:[o.jsx("input",{type:"text",placeholder:"미디어 검색...",value:p,onChange:I,style:{width:"100%",padding:"8px 12px",paddingLeft:"32px",backgroundColor:"#333",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px"}}),o.jsx("span",{style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#aaa"},children:"🔍"})]}),o.jsxs("select",{value:S,onChange:j,style:{padding:"7px 8px",backgroundColor:"#333",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px"},children:[o.jsx("option",{value:"name-asc",children:"이름 (A-Z)"}),o.jsx("option",{value:"name-desc",children:"이름 (Z-A)"}),o.jsx("option",{value:"importedAt-desc",children:"최근 추가"}),o.jsx("option",{value:"createdAt-desc",children:"생성일 (최신)"}),o.jsx("option",{value:"createdAt-asc",children:"생성일 (오래된)"}),o.jsx("option",{value:"size-desc",children:"크기 (큰 순)"}),o.jsx("option",{value:"size-asc",children:"크기 (작은 순)"}),o.jsx("option",{value:"duration-desc",children:"길이 (긴 순)"}),o.jsx("option",{value:"duration-asc",children:"길이 (짧은 순)"})]}),o.jsx("button",{onClick:N,title:"필터 초기화",style:{padding:"7px 10px",backgroundColor:"#333",border:"none",borderRadius:"4px",color:"#aaa",fontSize:"14px",cursor:"pointer"},children:"↺"})]}),o.jsxs("div",{className:"media-toolbar-right",style:{display:"flex",alignItems:"center",gap:"8px"},children:[o.jsx("div",{className:"selection-counter",style:{color:"#aaa",fontSize:"14px"},children:t>0?`${t}개 선택됨`:`${a}개 항목`}),o.jsx("button",{onClick:h,title:"새로고침",style:{padding:"8px 12px",backgroundColor:"#333",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",cursor:"pointer"},children:"↻"}),o.jsx("button",{onClick:f,disabled:t===0,style:{padding:"8px 12px",backgroundColor:t===0?"#333":"#e53935",border:"none",borderRadius:"4px",color:t===0?"#777":"#fff",fontSize:"14px",cursor:t===0?"default":"pointer",opacity:t===0?.7:1},children:"삭제"}),o.jsx("button",{onClick:n,style:{padding:"8px 16px",backgroundColor:"#2196f3",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",cursor:"pointer"},children:"미디어 추가"})]})]}),o.jsxs("div",{className:"media-toolbar-filters",style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"14px",color:"#ccc"},children:[o.jsxs("div",{className:"filter-group",children:[o.jsx("span",{style:{marginRight:"8px"},children:"타입:"}),o.jsxs("label",{style:{marginRight:"12px"},children:[o.jsx("input",{type:"checkbox",checked:((ee=r.type)==null?void 0:ee.includes(C.VIDEO))||!1,onChange:U=>E(C.VIDEO,U.target.checked),style:{marginRight:"4px"}}),"비디오"]}),o.jsxs("label",{style:{marginRight:"12px"},children:[o.jsx("input",{type:"checkbox",checked:((H=r.type)==null?void 0:H.includes(C.AUDIO))||!1,onChange:U=>E(C.AUDIO,U.target.checked),style:{marginRight:"4px"}}),"오디오"]}),o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:((M=r.type)==null?void 0:M.includes(C.IMAGE))||!1,onChange:U=>E(C.IMAGE,U.target.checked),style:{marginRight:"4px"}}),"이미지"]})]}),o.jsx("div",{className:"filter-group",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:r.favorite||!1,onChange:A,style:{marginRight:"4px"}}),"즐겨찾기만 표시"]})})]})]})};function Ie(t){if(t===0)return"0 Bytes";const a=1024,r=["Bytes","KB","MB","GB","TB"],n=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,n)).toFixed(2))+" "+r[n]}function je(t){if(isNaN(t))return"00:00";const a=Math.floor(t/3600),r=Math.floor(t%3600/60),n=Math.floor(t%60),s=f=>f.toString().padStart(2,"0");return a>0?`${s(a)}:${s(r)}:${s(n)}`:`${s(r)}:${s(n)}`}function Ye(t){return typeof t=="string"&&(t=new Date(t)),t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Nt(t){var r;const a=t.split(".");return a.length>1&&((r=a.pop())==null?void 0:r.toLowerCase())||""}function Ut(t){return t.split(/[\\/]/).pop()||""}const Ze=({item:t,isSelected:a,onSelect:r,onDoubleClick:n,onContextMenu:s,onDragStart:f})=>{const h=d=>{switch(d){case C.VIDEO:return"🎬";case C.AUDIO:return"🎵";case C.IMAGE:return"🖼️";default:return"📁"}},p=d=>{if(f?f(d,t):d.dataTransfer.setData("application/json",JSON.stringify({id:t.id,type:t.type,name:t.name,duration:t.metadata.duration})),t.thumbnail){const m=new Image;m.src=t.thumbnail,d.dataTransfer.setDragImage(m,0,0)}};return o.jsxs("div",{className:`media-item ${a?"selected":""}`,onClick:()=>r(t.id),onDoubleClick:()=>n&&n(t),onContextMenu:d=>s&&s(d,t),draggable:!0,onDragStart:p,"data-media-id":t.id,"data-media-type":t.type,style:{position:"relative",width:"180px",margin:"8px",borderRadius:"6px",overflow:"hidden",backgroundColor:"#232323",border:a?"2px solid #2196f3":"2px solid transparent",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.2)",cursor:"pointer",transition:"all 0.2s ease"},children:[o.jsxs("div",{className:"media-thumbnail",style:{position:"relative",width:"100%",height:"120px",backgroundColor:"#333",backgroundImage:t.thumbnail?`url(${t.thumbnail})`:"none",backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:[!t.thumbnail&&o.jsx("span",{style:{fontSize:"2rem"},children:h(t.type)}),o.jsx("div",{className:"media-type-badge",style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"12px"},children:t.type}),t.favorite&&o.jsx("div",{className:"favorite-badge",style:{position:"absolute",top:"8px",left:"8px",color:"#ffcf00",fontSize:"16px"},children:"★"}),t.metadata.duration&&(t.type===C.VIDEO||t.type===C.AUDIO)&&o.jsx("div",{className:"duration-badge",style:{position:"absolute",bottom:"8px",right:"8px",backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white",padding:"2px 6px",borderRadius:"4px",fontSize:"12px"},children:je(t.metadata.duration)})]}),o.jsxs("div",{className:"media-info",style:{padding:"8px",color:"white"},children:[o.jsx("div",{className:"media-name",style:{fontSize:"14px",fontWeight:"bold",marginBottom:"4px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:t.name,children:t.name}),o.jsxs("div",{className:"media-details",style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#aaa"},children:[o.jsx("span",{children:Ie(t.size)}),t.metadata.width&&t.metadata.height&&o.jsxs("span",{children:[t.metadata.width," × ",t.metadata.height]})]}),t.tags.length>0&&o.jsxs("div",{className:"media-tags",style:{marginTop:"4px",display:"flex",flexWrap:"wrap",gap:"4px"},children:[t.tags.slice(0,2).map((d,m)=>o.jsx("span",{style:{backgroundColor:"#454545",color:"#ddd",padding:"2px 4px",borderRadius:"4px",fontSize:"10px"},children:d},m)),t.tags.length>2&&o.jsxs("span",{style:{color:"#aaa",fontSize:"10px"},children:["+",t.tags.length-2]})]})]})]})},He=({items:t,selectedItems:a,onSelectItem:r,onItemDoubleClick:n,onItemContextMenu:s,onItemDragStart:f})=>{const h=c.useCallback((d,m)=>{const I=(m==null?void 0:m.ctrlKey)||(m==null?void 0:m.metaKey)||(m==null?void 0:m.shiftKey);r(d,I)},[r]),p=c.useCallback(d=>{d.target===d.currentTarget&&r("",!1)},[r]);return o.jsx("div",{className:"media-grid",onClick:p,style:{display:"flex",flexWrap:"wrap",padding:"16px",overflow:"auto",height:"100%",backgroundColor:"#1a1a1a"},children:t.length===0?o.jsxs("div",{className:"media-grid-empty",style:{width:"100%",textAlign:"center",color:"#777",padding:"32px",fontSize:"16px"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📁"}),o.jsx("p",{children:"미디어 파일이 없습니다"}),o.jsx("p",{style:{fontSize:"14px"},children:"파일을 드래그하거나 추가 버튼을 클릭하여 미디어를 가져오세요"})]}):t.map(d=>o.jsx(Ze,{item:d,isSelected:a.includes(d.id),onSelect:m=>h(m),onDoubleClick:n,onContextMenu:s,onDragStart:f},d.id))})},Je=({item:t,onClose:a,onFavoriteToggle:r,onTagAdd:n,onTagRemove:s})=>{const[f,h]=c.useState(""),[p,d]=c.useState(!1),m=c.useRef(null),I=async()=>{await r(t.id,!t.favorite)},E=async S=>{S.preventDefault(),f.trim()!==""&&(await n(t.id,f.trim()),h(""))},A=async S=>{await s(t.id,S)},j=()=>{switch(t.type){case C.VIDEO:return o.jsx("video",{ref:m,src:t.url,controls:!0,style:{width:"100%",height:"auto",maxHeight:"250px",backgroundColor:"#000",objectFit:"contain"}});case C.AUDIO:return o.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[o.jsx("audio",{src:t.url,controls:!0,style:{width:"100%"}}),o.jsx("div",{style:{marginTop:"16px",fontSize:"48px",color:"#aaa"},children:"🎵"})]});case C.IMAGE:return o.jsx("img",{src:t.url,alt:t.name,style:{width:"100%",height:"auto",maxHeight:"250px",objectFit:"contain"}});default:return o.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#aaa"},children:"미리보기를 사용할 수 없음"})}};return o.jsxs("div",{className:"media-preview",style:{display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#232323"},children:[o.jsxs("div",{className:"preview-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid #333"},children:[o.jsx("h3",{style:{margin:0,fontSize:"16px",fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:t.name,children:t.name}),o.jsxs("div",{className:"preview-actions",children:[o.jsx("button",{onClick:I,title:t.favorite?"즐겨찾기 해제":"즐겨찾기 추가",style:{background:"none",border:"none",fontSize:"18px",color:t.favorite?"#ffcf00":"#777",cursor:"pointer",marginRight:"8px"},children:t.favorite?"★":"☆"}),o.jsx("button",{onClick:a,title:"미리보기 닫기",style:{background:"none",border:"none",fontSize:"18px",color:"#777",cursor:"pointer"},children:"✕"})]})]}),o.jsx("div",{className:"preview-content",style:{borderBottom:"1px solid #333"},children:j()}),o.jsxs("div",{className:"preview-details",style:{flex:1,overflow:"auto",padding:"16px"},children:[o.jsx("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa",width:"40%"},children:"타입"}),o.jsx("td",{style:{padding:"4px 0"},children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]}),o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"크기"}),o.jsx("td",{style:{padding:"4px 0"},children:Ie(t.size)})]}),t.metadata.duration!==void 0&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"길이"}),o.jsx("td",{style:{padding:"4px 0"},children:je(t.metadata.duration)})]}),t.metadata.width&&t.metadata.height&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"해상도"}),o.jsxs("td",{style:{padding:"4px 0"},children:[t.metadata.width," × ",t.metadata.height]})]}),t.metadata.frameRate!==void 0&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"프레임 레이트"}),o.jsxs("td",{style:{padding:"4px 0"},children:[t.metadata.frameRate," fps"]})]}),t.metadata.codec&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"코덱"}),o.jsx("td",{style:{padding:"4px 0"},children:t.metadata.codec})]}),t.metadata.channels!==void 0&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"오디오 채널"}),o.jsxs("td",{style:{padding:"4px 0"},children:[t.metadata.channels," (",t.metadata.channels===1?"모노":t.metadata.channels===2?"스테레오":t.metadata.channels===6?"5.1":t.metadata.channels===8?"7.1":`${t.metadata.channels}채널`,")"]})]}),t.metadata.sampleRate!==void 0&&o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"샘플 레이트"}),o.jsxs("td",{style:{padding:"4px 0"},children:[(t.metadata.sampleRate/1e3).toFixed(1)," kHz"]})]}),o.jsxs("tr",{children:[o.jsx("td",{style:{padding:"4px 8px 4px 0",color:"#aaa"},children:"임포트 날짜"}),o.jsx("td",{style:{padding:"4px 0"},children:Ye(t.importedAt)})]})]})}),o.jsxs("div",{className:"tags-section",style:{marginTop:"16px",borderTop:"1px solid #333",paddingTop:"16px"},children:[o.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:"14px",fontWeight:"bold",color:"#aaa"},children:"태그"}),o.jsx("div",{className:"tags-list",style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"12px"},children:t.tags.length===0?o.jsx("span",{style:{color:"#777",fontSize:"14px"},children:"태그 없음"}):t.tags.map((S,N)=>o.jsxs("span",{style:{backgroundColor:"#454545",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",display:"inline-flex",alignItems:"center"},children:[S,o.jsx("button",{onClick:()=>A(S),style:{background:"none",border:"none",color:"#aaa",marginLeft:"4px",fontSize:"12px",cursor:"pointer",padding:"0"},title:"태그 삭제",children:"✕"})]},N))}),o.jsx("form",{onSubmit:E,children:o.jsxs("div",{className:"tag-input-container",style:{position:"relative",display:"flex"},children:[o.jsx("input",{type:"text",value:f,onChange:S=>h(S.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"새 태그 추가...",style:{flex:1,padding:"6px 10px",backgroundColor:"#333",border:p?"1px solid #2196f3":"1px solid #444",borderRadius:"4px",color:"#fff",fontSize:"14px",outline:"none"}}),o.jsx("button",{type:"submit",disabled:f.trim()==="",style:{padding:"6px 12px",marginLeft:"8px",backgroundColor:f.trim()===""?"#444":"#2196f3",border:"none",borderRadius:"4px",color:"#fff",fontSize:"14px",cursor:f.trim()===""?"default":"pointer",opacity:f.trim()===""?.7:1},children:"추가"})]})})]})]})]})},Ft=({onSelect:t,onDragStart:a})=>{const{state:{items:r,selectedItems:n,filter:s,isLoading:f},importMedia:h,refreshMedia:p,updateMedia:d,deleteMedia:m,selectItem:I,deselectItem:E,deselectAll:A,setFilter:j}=Ve(),[S,N]=c.useState(null),ee=c.useRef(null),H=c.useCallback(()=>{var u;(u=ee.current)==null||u.click()},[]),M=c.useCallback(async u=>{const w=u.target.files;!w||w.length===0||(await h(Array.from(w)),u.target.value="")},[h]),U=c.useCallback(async u=>{u.preventDefault(),u.stopPropagation();const w=u.dataTransfer.files;w.length!==0&&await h(Array.from(w))},[h]),G=c.useCallback(u=>{u.preventDefault(),u.stopPropagation()},[]),q=c.useCallback((u,w=!1)=>{if(u===""){A(),N(null);return}w?n.includes(u)?E(u):I(u):(A(),I(u));const k=r.find(J=>J.id===u);k&&N(k)},[n,r,I,E,A]),x=c.useCallback(u=>{t&&t([u])},[t]),b=c.useCallback(async()=>{if(!(n.length===0||!window.confirm(`선택한 ${n.length}개 항목을 삭제하시겠습니까?`))){for(const w of n)await m(w);N(null)}},[n,m]);return c.useEffect(()=>{p()},[p]),o.jsxs("div",{className:"media-manager",style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:"#1a1a1a",color:"#fff"},onDrop:U,onDragOver:G,children:[o.jsx(Ge,{selectedCount:n.length,totalCount:r.length,filter:s,onImport:H,onFilterChange:j,onDeleteSelected:b,onRefresh:()=>p()}),o.jsxs("div",{className:"media-content",style:{display:"flex",flex:1,overflow:"hidden"},children:[o.jsxs("div",{className:"media-grid-container",style:{flex:3,overflow:"hidden",position:"relative",borderRight:"1px solid #333"},children:[f&&o.jsx("div",{className:"loading-overlay",style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.6)",zIndex:10},children:o.jsx("div",{className:"spinner",style:{color:"#fff",fontSize:"16px"},children:"로딩 중..."})}),o.jsx(He,{items:r,selectedItems:n,onSelectItem:q,onItemDoubleClick:x,onItemDragStart:a})]}),o.jsx("div",{className:"media-preview-container",style:{flex:1,minWidth:"300px",display:"flex",flexDirection:"column",overflow:"hidden"},children:S?o.jsx(Je,{item:S,onClose:()=>N(null),onFavoriteToggle:async(u,w)=>{await d(u,{favorite:w})},onTagAdd:async(u,w)=>{const k=r.find(J=>J.id===u);k&&!k.tags.includes(w)&&await d(u,{tags:[...k.tags,w]})},onTagRemove:async(u,w)=>{const k=r.find(J=>J.id===u);k&&await d(u,{tags:k.tags.filter(J=>J!==w)})}}):o.jsxs("div",{className:"no-preview",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#777",padding:"20px",textAlign:"center"},children:[o.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"👆"}),o.jsx("p",{children:"항목을 선택하여 미리보기"}),o.jsx("p",{style:{fontSize:"14px",marginTop:"8px"},children:"미디어 파일을 선택하면 미리보기와 상세 정보가 표시됩니다"})]})})]}),o.jsx("input",{type:"file",ref:ee,onChange:M,multiple:!0,accept:"video/*,audio/*,image/*",style:{display:"none"}})]})},zt=()=>{const[t,a]=c.useState([]),[r,n]=c.useState([]),[s,f]=c.useState(!1),[h,p]=c.useState(null),[d,m]=c.useState({}),I=c.useCallback(async x=>{try{f(!0),p(null),await te.load();const b=await Q.importMedia(x);return a(u=>[...u,...b]),b}catch(b){const u=b instanceof Error?b:new Error("미디어 임포트 중 오류 발생");return p(u),[]}finally{f(!1)}},[]),E=c.useCallback(async x=>{try{f(!0),p(null);const b=x||d;x&&m(x);const u=await Q.getMediaItems(b);a(u)}catch(b){const u=b instanceof Error?b:new Error("미디어 새로고침 중 오류 발생");p(u)}finally{f(!1)}},[d]),A=c.useCallback(async(x,b)=>{try{p(null);const u=await Q.updateMedia(x,b);return a(w=>w.map(k=>k.id===x?u:k)),u}catch(u){const w=u instanceof Error?u:new Error("미디어 업데이트 중 오류 발생");throw p(w),w}},[]),j=c.useCallback(async x=>{try{p(null);const b=await Q.deleteMedia(x);return b&&(a(u=>u.filter(w=>w.id!==x)),n(u=>u.filter(w=>w!==x))),b}catch(b){const u=b instanceof Error?b:new Error("미디어 삭제 중 오류 발생");return p(u),!1}},[]),S=c.useCallback(async x=>{try{return p(null),await te.load(),await Q.extractMetadata(x)}catch(b){const u=b instanceof Error?b:new Error("메타데이터 추출 중 오류 발생");throw p(u),u}},[]),N=c.useCallback(async(x,b)=>{try{p(null);const u=await Q.generateThumbnail(x,b);return a(w=>w.map(k=>k.id===x.id?{...k,thumbnail:u}:k)),u}catch(u){const w=u instanceof Error?u:new Error("썸네일 생성 중 오류 발생");throw p(w),w}},[]),ee=c.useCallback(async(x,b,u,w={})=>{try{const k=new Date,pe={id:Ue(),name:x,type:b,path:u,url:u,size:0,createdAt:k,importedAt:k,metadata:w,tags:[],favorite:!1,thumbnail:""};return a(K=>[...K,pe]),pe}catch(k){const J=k instanceof Error?k:new Error("미디어 항목 생성 중 오류 발생");throw p(J),J}},[]),H=c.useCallback(x=>{n(b=>b.includes(x)?b:[...b,x])},[]),M=c.useCallback(x=>{n(b=>b.filter(u=>u!==x))},[]),U=c.useCallback(()=>{n(t.map(x=>x.id))},[t]),G=c.useCallback(()=>{n([])},[]),q=c.useCallback(x=>{m(x),E(x)},[E]);return c.useEffect(()=>(E(),()=>{te.terminate().catch(console.error)}),[E]),{items:t,selectedItems:r,isLoading:s,error:h,filter:d,importMedia:I,refreshMedia:E,updateMedia:A,deleteMedia:j,extractMetadata:S,generateThumbnail:N,createMediaItem:ee,selectItem:H,deselectItem:M,selectAll:U,deselectAll:G,applyFilter:q}};y.FFmpegService=te,y.MediaGrid=He,y.MediaItem=Ze,y.MediaManager=Ft,y.MediaPreview=Je,y.MediaProvider=Pt,y.MediaService=Q,y.MediaToolbar=Ge,y.MediaType=C,y.formatDate=Ye,y.formatDuration=je,y.formatFileSize=Ie,y.getBasename=Ut,y.getFileExtension=Nt,y.useMedia=zt,y.useMediaContext=Ve,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})});
